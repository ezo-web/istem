<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>I-STEM Council — Dashboard</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <link rel="stylesheet" href="assets/style.css" />
  <script>
    // Auto-detect and set base href for GitHub Pages subdirectory deployments
    if (window.location.hostname === 'ezo-web.github.io' && !document.querySelector('base')) {
      const base = document.createElement('base');
      base.href = '/istem/';
      document.head.insertBefore(base, document.head.firstChild);
    }
  </script>
</head>
<body>
  <header class="topbar">
    <div class="brand">HDSB I-STEM Comms</div>
    <div class="desc">Announcements & Resources</div>
    <button id="adminBtn" class="admin-btn">Admin Login</button>
  </header>

  <main class="app">
    <section class="col left">
      <div class="panel">
        <div class="panel-header">
          <h2>Announcements</h2>
          <input id="searchAnnouncements" class="search" placeholder="Search announcements..." />
        </div>
        <ul id="announcementsList" class="list"></ul>
      </div>
    </section>

    <section class="col right">
      <div class="panel">
        <div class="panel-header">
          <h2>Resources</h2>
          <input id="searchResources" class="search" placeholder="Search resources..." />
        </div>
        <ul id="resourcesList" class="list"></ul>
      </div>
    </section>
      <div style="display: flex; justify-content: flex-end; margin-bottom: 12px;">
        <button id="reloadDataBtn" class="btn" title="Reload announcements and resources">Reload</button>
      </div>
  </main>

  <footer class="footer">
    <small>Built for the HDSB I-STEM Council at Aldershot School — © 2025 Yazan Kazour</small>
    <small>By using this site, you acknoladge the <a href="https://docs.google.com/document/d/e/2PACX-1vTT7a0hqDYDpFNEhi78tUzEiVlRdbzI7L6nUHTfyUcHOSBS5F7ckAus7iVvl4Tn8kCDXiE28LbfPa24/pub"></a>Privacy Statement</a></small>
  </footer>

  <template id="announcementTpl">
    <li class="card announcement">
      <div class="card-head">
        <h3 class="title"></h3>
        <time class="date"></time>
      </div>
      <p class="body"></p>
    </li>
  </template>

  <template id="resourceTpl">
    <li class="card resource">
      <div class="card-head">
        <h3 class="title"></h3>
        <span class="type"></span>
      </div>
      <p class="body"></p>
      <a class="link" target="_blank" rel="noopener noreferrer">Open</a>
    </li>
  </template>

  <!-- Admin panel -->
  <div id="adminPanel" class="admin-panel" hidden>
    <div class="admin-card">
      <button id="closeAdmin" class="close-btn">×</button>
      <h3>Admin Login</h3>
      
      <div id="adminSignedOut">
        <form id="loginForm" class="admin-form">
          <label>UID<input id="loginUid" name="uid" required /></label>
          <label>Password<input id="loginPassword" name="password" type="password" required /></label>
          <div class="admin-actions">
            <button type="submit" class="btn">Sign In</button>
          </div>
        </form>
      </div>

      <div id="adminSignedIn" hidden>
        <p style="margin: 0 0 12px 0; color: #059669; font-weight: 600;">✓ Signed in as <span id="adminUID"></span></p>
      </div>

      <div id="adminControls" hidden>
        <h4>Create Announcement</h4>
        <form id="createAnnouncementForm" class="admin-form">
          <input id="annTitle" placeholder="Title" required />
          <input id="annDate" type="date" />
          <textarea id="annBody" placeholder="Body" rows="3"></textarea>
          <label><input id="annPinned" type="checkbox" /> Pinned</label>
          <div class="admin-actions"><button class="btn" type="submit">Create</button></div>
        </form>

        <h4>Create Resource</h4>
        <form id="createResourceForm" class="admin-form">
          <input id="resTitle" placeholder="Title" required />
          <input id="resType" placeholder="Type (e.g., Document)" />
          <input id="resLink" placeholder="Link (https://...)" />
          <textarea id="resDesc" placeholder="Description" rows="2"></textarea>
          <div class="admin-actions"><button class="btn" type="submit">Create</button></div>
        </form>

        <div class="admin-actions">
          <button id="signOutBtn" class="btn alt">Sign Out</button>
        </div>
      </div>

      <div id="adminMsg" class="admin-msg"></div>
    </div>
  </div>

  <script type="module" src="assets/app.js"></script>
</body>
</html>
